<div class="role-permissions-container">
  <div class="header">
    <h2>Role Permissions Management</h2>
  </div>

  <div class="role-selector">
    <label class="role-label">Select Role</label>
    <mat-form-field appearance="outline" class="role-select">
      <mat-select [(ngModel)]="selectedRole" (selectionChange)="onRoleChange()">
        <mat-option *ngFor="let role of roles" [value]="role.id">{{ role.name }}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <div *ngIf="selectedRole >= 1" class="permissions-section">
    <table mat-table [dataSource]="menus" class="mat-elevation-z8">
      <ng-container matColumnDef="component">
        <th mat-header-cell *matHeaderCellDef>Component</th>
        <td mat-cell *matCellDef="let menu">{{ menu.name }}</td>
      </ng-container>
      
      <ng-container matColumnDef="view">
        <th mat-header-cell *matHeaderCellDef>View</th>
        <td mat-cell *matCellDef="let menu">
          <mat-checkbox 
            [checked]="hasPermission(menu.id, 'view')"
            (change)="onPermissionChange(menu.id, 'view', $event)">
          </mat-checkbox>
        </td>
      </ng-container>
      
      <ng-container matColumnDef="create">
        <th mat-header-cell *matHeaderCellDef>Create</th>
        <td mat-cell *matCellDef="let menu">
          <mat-checkbox 
            [checked]="hasPermission(menu.id, 'create')"
            (change)="onPermissionChange(menu.id, 'create', $event)">
          </mat-checkbox>
        </td>
      </ng-container>
      
      <ng-container matColumnDef="edit">
        <th mat-header-cell *matHeaderCellDef>Edit</th>
        <td mat-cell *matCellDef="let menu">
          <mat-checkbox 
            [checked]="hasPermission(menu.id, 'edit')"
            (change)="onPermissionChange(menu.id, 'edit', $event)">
          </mat-checkbox>
        </td>
      </ng-container>
      
      <ng-container matColumnDef="delete">
        <th mat-header-cell *matHeaderCellDef>Delete</th>
        <td mat-cell *matCellDef="let menu">
          <mat-checkbox 
            [checked]="hasPermission(menu.id, 'delete')"
            (change)="onPermissionChange(menu.id, 'delete', $event)">
          </mat-checkbox>
        </td>
      </ng-container>
      
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <div class="actions">
      <button mat-raised-button color="primary" (click)="savePermissions()">Save Permissions</button>
      <button mat-raised-button color="accent" (click)="loadPermissions()">Reset</button>
    </div>
  </div>

  <div *ngIf="selectedRole < 1" class="no-selection">
    <p>Please select a role to manage permissions</p>
  </div>
</div>